{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js"],"sourcesContent":["import { getImages, toggleLoadMoreBtn, showLoader, hideLoader } from \"./pixabay-api\"; \nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nconst galleryList = document.querySelector(\".gallery-list\")\nconst searchButton = document.querySelector(\"button\")\nconst loader = document.querySelector(\".loader\");\n\nexport function clearGallery() {\n    galleryList.innerHTML = \"\";\n}\n\nsearchButton.addEventListener(\"click\", async () => {\n    showLoader();\n\n    try {\n        const imagesGenerating = await getImages();\n        galleryList.innerHTML = appendImageCard(imagesGenerating.hits);\n        loader.style.display = \"none\";\n        const lightbox = new SimpleLightbox('.gallery-link');\n        lightbox.refresh();\n        toggleLoadMoreBtn();\n    }\n\n    catch (error) {\n        console.log(\"Error:\", error);\n        hideLoader();\n    }\n});\n\nexport function appendImageCard(imagesGenerating) {\n    return imagesGenerating.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\" class=\"gallery-link\" alt=\"${tags}\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/>\n        </a>\n            <div class=\"wrapper-descs\">\n            <div class=\"wrapper-desc\">\n                <p class=\"desc\">Likes</p>\n                <p class=\"desc-values\">${likes}</p>\n                </div>\n                <div class=\"wrapper-desc\">\n                <p class=\"desc\">Views</p>\n                <p class=\"desc-values\">${views}</p>\n                </div>\n                <div class=\"wrapper-desc\">\n                <p class=\"desc\">Comments</p>\n                <p class=\"desc-values\">${comments}</p>\n                </div>\n                <div class=\"wrapper-desc\">\n                <p class=\"desc\">Downloads</p>\n                <p class=\"desc-values\">${downloads}</p>\n                </div>\n            </div>\n        </li>`).join(\"\");\n}\n\nexport function getItemHeight(galleryItem) {\n    if (galleryItem) {\n        const { height } = galleryItem.getBoundingClientRect();\n        return height;\n    }\n    return 0;\n}","import { clearGallery, appendImageCard, getItemHeight } from \"./render-functions\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from 'axios';\n\nconst inputText = document.querySelector(\"input\");\nconst formImage = document.querySelector(\"form\");\nconst loadMoreBtn = document.querySelector(\".load-more-button\")\nconst galleryList = document.querySelector(\".gallery-list\");\nconst galleryItem = document.querySelector(\".gallery-item\");\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst KEY = '42561040-543dc47762d23067e130ec962';\nlet QUERY = null;\ninputText.addEventListener(\"input\", event => {\n    QUERY = inputText.value;\n});\n\nlet current_page = 1;\n\nexport async function getImages(page = 1) {\n    if (page === 1) {\n        clearGallery();\n    }\n\n    const LINK = `?key=${KEY}&q=${QUERY}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=15`;\n\n    try {\n        const response = await axios.get(LINK);\n\n        if (response.status !== 200) {\n            throw new Error(\"Image error\");\n        }\n\n        const { hits, totalHits } = response.data\n\n        if (hits.length === 0) {\n            hideLoader()\n            iziToast.warning({\n                title: 'Caution',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: \"topRight\",\n            });\n        }\n\n        return { hits, totalHits };\n\n    } catch (error) {\n        hideLoader()\n        iziToast.error({\n            title: 'Caution',\n            message: 'Error while fetching images from pixabay',\n            position: \"topRight\",\n        });\n        return { hits: [], totalHits: 0 };\n    }\n}\n\nformImage.addEventListener(\"submit\", (event) => {\n    event.preventDefault();\n    QUERY = event.target.elements.value;\n    current_page = 1;\n    getImages();\n    toggleLoadMoreBtn();\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n    showLoader();\n    current_page++;\n\n    try {\n        const { hits, totalHits } = await getImages(current_page);\n\n        if (hits.length > 0) {\n            galleryList.innerHTML += appendImageCard(hits);\n            toggleLoadMoreBtn();\n\n            const galleryItem = document.querySelector(\".gallery-item\");\n            const galleryItemHeight = getItemHeight(galleryItem);\n\n            window.scrollBy({\n                top: galleryItemHeight * 2,\n                behavior: 'smooth'\n            });\n\n            const lightbox = new SimpleLightbox('.gallery-link');\n            lightbox.refresh();\n        }\n\n        if (current_page * 15 >= totalHits) {\n            hideLoader();\n            loadMoreBtn.style.display = \"none\";\n            iziToast.info({\n                title: 'Caution',\n                message: \"We`re sorry, but you`ve reached the end of search results.\",\n                position: \"topRight\",\n            });\n        }\n\n    } catch (error) {\n        console.log(\"Error:\", error);\n    } finally {\n        hideLoader();\n    }\n});\n\nexport function toggleLoadMoreBtn() {\n    loadMoreBtn.style.display = galleryList.children.length > 0 ? \"block\" : \"none\";\n}\n\nexport function showLoader() {\n    const loader = document.querySelector(\".loader\");\n    loader.style.display = \"block\";\n}\n\nexport function hideLoader() {\n    const loader = document.querySelector(\".loader\");\n    loader.style.display = \"none\";\n}\n"],"names":["galleryList","searchButton","loader","clearGallery","showLoader","imagesGenerating","getImages","appendImageCard","SimpleLightbox","toggleLoadMoreBtn","error","hideLoader","webformatURL","largeImageURL","tags","likes","views","comments","downloads","getItemHeight","galleryItem","height","inputText","formImage","loadMoreBtn","axios","KEY","QUERY","event","current_page","page","LINK","response","hits","totalHits","iziToast","galleryItemHeight"],"mappings":"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"}